<!doctype html><html lang=en class=scroll-smooth data-default-appearance=light><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Build Emacs On Windows &#183; Chuck</title><meta name=title content="Build Emacs On Windows &#183; Chuck"><meta name=description content="A powerful, lightweight theme for Hugo."><meta name=keywords content="Emacs,Windows,MSYS2"><meta name=author content="Chuck"><link type=text/css rel=stylesheet href=/css/main.bundle.min.css><script type=text/javascript src=/js/appearance.min.js></script><script defer type=text/javascript src=/js/main.bundle.min.js></script></head><body><header class=header><nav class=site-header><a class=title href=https://xuchengpeng.cn/>Chuck</a><div class=menu><div id=menu-list class=main-menu><a href=/posts/>Posts</a><a href=/projects/>Projects</a><a href=/about/>About</a></div><button aria-label=Search onclick='window.location.href="/search/"'>
<svg width="20" height="20" viewBox="0 0 24 24"><path fill="currentcolor" d="M23.822 20.88l-6.353-6.354c.93-1.465 1.467-3.2 1.467-5.059.001-5.219-4.247-9.467-9.468-9.467S0 4.248.0 9.468c0 5.221 4.247 9.469 9.468 9.469 1.768.0 3.421-.487 4.839-1.333L20.703 24l3.119-3.12zM3.528 9.468c0-3.273 2.665-5.938 5.939-5.938 3.275.0 5.94 2.664 5.94 5.938.0 3.275-2.665 5.939-5.94 5.939-3.274.0-5.939-2.664-5.939-5.939z"/></svg>
</button>
<button id=appearance-switcher aria-label="Appearance Switcher">
<svg id="moon" width="20" height="20" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg>
<svg id="sun" width="20" height="20" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg>
</button>
<button id=menu-button aria-label=Menu>
<svg width="20" height="20" viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></button></div></nav></header><main class=main><article class=article><div class=article-header><div class=breadcrumbs><a href=/posts/>Posts</a>
<span>/</span></div><h1 class=article-title>Build Emacs On Windows</h1><div class=article-meta><span title=2024-04-01T00:00:00+00:00>1 April 2024</span>&#183;<span title='Word count'>474 words</span>&#183;<span title='Reading time'>3 min</span></div><div class=article-tags><a href=/tags/emacs/>Emacs</a><a href=/tags/windows/>Windows</a><a href=/tags/msys2/>MSYS2</a></div></div><div class=article-content><div class=content><section><p>On Windows, we can build GNU Emacs with <a href=https://www.msys2.org/>MSYS2</a> and <a href=https://www.mingw-w64.org/>MinGW-w64</a>.</p><p>First, install some necessary packages. The packages include the base developer tools, the compiler toolchain, several image libraries, and XML library, the GnuTLS library, zlib for decompressing text, HarfBuzz for use as the shaping engine, libgccjit for native-compilation support, SQLite3 for accessing SQL databases, and the tree-sitter library used by some major modes. You can select only part of the libraries if you don&rsquo;t need them all.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pacman --noconfirm -S --needed <span class=se>\
</span></span></span><span class=line><span class=cl>    base-devel <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-toolchain <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-xpm-nox <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-gmp <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-gnutls <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-libtiff <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-giflib <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-libpng <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-libjpeg-turbo <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-librsvg <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-libwebp <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-lcms2 <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-libxml2 <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-zlib <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-harfbuzz <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-libgccjit <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-sqlite3 <span class=se>\
</span></span></span><span class=line><span class=cl>    mingw-w64-x86_64-libtree-sitter
</span></span></code></pre></div><p>Then, use git to clone the repository, we also need autotools to generate the configure script.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pacman --noconfirm -S git autotools
</span></span><span class=line><span class=cl>git config --global core.autocrlf <span class=nb>false</span>
</span></span></code></pre></div><p>You now have a complete build environment for Emacs.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mkdir /c/emacs
</span></span><span class=line><span class=cl><span class=nb>cd</span> /c/emacs
</span></span><span class=line><span class=cl>git clone --depth<span class=o>=</span><span class=m>1</span> https://git.savannah.gnu.org/git/emacs.git emacs-master
</span></span><span class=line><span class=cl><span class=nv>install_dir</span><span class=o>=</span>/c/programs/emacs
</span></span><span class=line><span class=cl><span class=nb>cd</span> /c/emacs/emacs-master
</span></span><span class=line><span class=cl>./autogen.sh
</span></span><span class=line><span class=cl>./configure --prefix<span class=o>=</span><span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span> --with-native-compilation<span class=o>=</span>aot --with-tree-sitter --without-dbus --without-pop
</span></span><span class=line><span class=cl><span class=nv>NPROC</span><span class=o>=</span><span class=k>$(</span>nproc<span class=k>)</span>
</span></span><span class=line><span class=cl>make -j<span class=si>${</span><span class=nv>NPROC</span><span class=si>}</span>
</span></span><span class=line><span class=cl>make install
</span></span></code></pre></div><p>After building and installing, we need to copy necessary DLLs into Emacs&rsquo;s bin directory if we run Emacs outside the mingw64 shell.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cp -v /mingw64/bin/libbrotlicommon.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libbrotlidec.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libbrotlienc.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libbz*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libcairo-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libdatrie-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libdeflate.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libexpat-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libffi-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libfontconfig-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libfreetype-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libfribidi-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgcc_s_seh-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgdk_pixbuf-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgif-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgio-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libglib-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgmodule-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgmp-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgnutls-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgobject-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgraphite*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libharfbuzz-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libhogweed-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libiconv-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libidn*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libintl-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libisl-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libjbig-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libjpeg-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/liblcms*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libLerc.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/liblzma-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libmpc-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libmpfr-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libnettle-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libp11-kit-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libpango-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libpangocairo-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libpangoft*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libpangowin32-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libpcre*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libpixman-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libpng*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/librsvg*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libsharpyuv-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libsqlite*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libstdc++-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libtasn1-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libthai-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libtiff-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libtree-sitter-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin/libtree-sitter.dll
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libunistring-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libwebp-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libwebpdemux-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libwinpthread-*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libxml*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libXpm*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libzstd.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/wasmtime.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/zlib*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libgccjit*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/bin
</span></span><span class=line><span class=cl>mkdir -p <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/lib/gcc
</span></span><span class=line><span class=cl>cp -v /mingw64/lib/<span class=o>{</span>crtbegin,crtend,dllcrt2<span class=o>}</span>.o <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/lib/gcc
</span></span><span class=line><span class=cl>cp -v /mingw64/lib/lib<span class=o>{</span>advapi32,gcc_s,kernel32,mingw32,mingwex,moldname,msvcrt,pthread,shell32,user32<span class=o>}</span>.a <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/lib/gcc
</span></span><span class=line><span class=cl>cp -v /mingw64/lib/gcc/x86_64-w64-mingw32/14.2.0/libgcc.a <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/lib/gcc
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/<span class=o>{</span>ld,as<span class=o>}</span>.exe <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/lib/gcc
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/libzstd.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/lib/gcc
</span></span><span class=line><span class=cl>cp -v /mingw64/bin/zlib*.dll <span class=si>${</span><span class=nv>install_dir</span><span class=si>}</span>/lib/gcc
</span></span></code></pre></div></section><section><h2>Related</h2><div class=article-entries><div class=article-entry><h3 class=article-title><a href=/posts/build-emacs-from-source/>Build Emacs From Source</a></h3><div class=article-meta><span title=2024-03-08T00:00:00+00:00>8 March 2024</span>&#183;<span title='Word count'>203 words</span>&#183;<span title='Reading time'>1 min</span></div><div class=article-tags><a href=/tags/emacs/>Emacs</a><a href=/tags/linux/>Linux</a><a href=/tags/wsl/>WSL</a></div><div class=article-summary><p>A guide to build emacs from source on Linux.</p></div></div><div class=article-entry><h3 class=article-title><a href=/posts/emacs-proxy/>Emacs Proxy</a></h3><div class=article-meta><span title=2024-02-05T00:00:00+00:00>5 February 2024</span>&#183;<span title='Word count'>196 words</span>&#183;<span title='Reading time'>1 min</span></div><div class=article-tags><a href=/tags/emacs/>Emacs</a></div><div class=article-summary><p>Proxy servers are commonly used to provide gateways through firewalls or as caches serving some more-or-less local network.</p></div></div><div class=article-entry><h3 class=article-title><a href=/posts/emacs-tokyonight-themes/>Emacs tokyonight-themes</a></h3><div class=article-meta><span title=2024-02-01T00:00:00+00:00>1 February 2024</span>&#183;<span title='Word count'>233 words</span>&#183;<span title='Reading time'>2 min</span></div><div class=article-tags><a href=/tags/emacs/>Emacs</a><a href=/tags/themes/>Themes</a></div><div class=article-summary><p>A clean dark Visual Studio Code theme that celebrates the lights of Downtown Tokyo at night.</p></div></div></div></section></div></div><div class=article-footer><div class=article-pagination><div class=prev><a href=/posts/build-emacs-from-source/><span>&larr; Build Emacs From Source</span></a></div><div class=next><a href=/posts/cpp-fold-expressions/><span>C++ Fold Expressions &rarr;</span></a></div></div></div></article></main><footer class=footer><div class=site-footer><div class=footer-menu><a href=/tags/>Tags</a><a href=/categories/>Categories</a></div><div class=footer-content><p>&copy; 2026 <a href=https://xuchengpeng.cn/>Chuck</a></p><p>Powered by <a href=https://gohugo.io/>Hugo</a></p></div></div><a href=#top class=top-link id=top-link><svg height="24" width="24" viewBox="0 -960 960 960" fill="currentcolor"><path d="M440-160v-487L216-423l-56-57 320-320 320 320-56 57-224-224v487h-80z"/></svg></a></footer></body></html>